{"version":3,"file":"owly-webflow.umd.js","sources":["../src/lib/create-http-client.js","../src/owly-api-http-client.js","../src/get-project-availability.js","../src/init-form.js"],"sourcesContent":["import axios from 'axios';\n\nfunction composeUrl(url, params = {}) {\n  const matches = url.match(/\\{([a-zA-Z0-9_]+)}/g);\n\n  if (matches) {\n    let parsedUrl = url;\n\n    matches.forEach((match) => {\n      const name = match.replace(/{?}?/g, '');\n\n      parsedUrl = parsedUrl.replace(match, params[name] || '');\n    });\n\n    return parsedUrl;\n  }\n\n  return url;\n}\n\n/**\n * Endpoint call options\n * @typedef {Object} EndpointCallOptions\n * @property {Object} [urlParams] - params used to compose the API url\n * @property {RequestConfig} [config] - axios config\n * @property {Object} [data] - data\n */\n\n/**\n * @typedef {import('axios').AxiosRequestConfig} RequestConfig\n * @typedef {import('axios').AxiosResponse} Response\n * @callback EndpointCallFn\n * @param {EndpointCallOptions} [options] - endpoint call options\n * @returns {Promise<Response>}\n */\n\n/**\n * Create http client\n * @typedef {{\n *   method: ('get'|'post'|'delete'|'head'|'options')\n *   url: string\n * }} EndpointConfig\n * @param {Object} options - http client config options\n * @param {string} options.baseURL - the server URL that will be used for the request\n * @param {Object<string, string>} [options.headers={}] - custom headers to be sent\n * @param {Object<string, EndpointConfig>} [options.endpoints={}] - endpoints config\n * @param {number} [options.timeout=30000] - the number of milliseconds before the request times out\n * @returns {Object<string, EndpointCallFn>}\n */\nfunction createHttpClient({\n  baseURL,\n  headers = {},\n  endpoints = {},\n  timeout = 30000,\n}) {\n  const axiosInstance = axios.create({ baseURL, headers, timeout });\n  const httpClient = {};\n\n  Object.entries(endpoints).forEach(([endpointName, options]) => {\n    const { url, method } = options;\n\n    httpClient[endpointName] = ({ urlParams, config = {}, data = {} } = {}) => {\n      const composedUrl = composeUrl(url, urlParams);\n\n      if (['get', 'delete', 'head', 'options'].includes(method)) {\n        return axiosInstance[method](composedUrl, config);\n      }\n\n      return axiosInstance[method](composedUrl, data, config);\n    };\n  });\n\n  return httpClient;\n}\n\nexport default createHttpClient;\n","import createHttpClient from './lib/create-http-client';\n\n/**\n * @typedef {import('./lib/create-http-client').EndpointCallFn} EndpointCallFn\n * @typedef {Object} OwlyHttpClient\n * @property {EndpointCallFn} getProject\n * @property {EndpointCallFn} createLead\n */\n\n/** @type {OwlyHttpClient} */\nexport const owlyApiHttpClient = createHttpClient({\n  baseURL: 'https://api.owly.com.co',\n  endpoints: {\n    getProject: {\n      method: 'get',\n      url: '/projects/{projectId}',\n    },\n    createLead: {\n      method: 'post',\n      url: '/leads/',\n    },\n  },\n});\n","import { owlyApiHttpClient } from './owly-api-http-client';\n\nexport default async function getProjectAvailability(options) {\n  const {\n    product,\n    companyCode,\n    projectId,\n    token,\n    itemCallback,\n    limit = 400,\n  } = options;\n\n  const { status, data } = await owlyApiHttpClient.getProject({\n    config: {\n      params: {\n        product,\n        companyCode,\n        limit,\n        token,\n      },\n    },\n    urlParams: {\n      projectId,\n    },\n  });\n\n  if (status === 200 && data.items?.length) {\n    data.items.forEach((item) => {\n      if (itemCallback && typeof itemCallback === 'function') {\n        itemCallback(item);\n      }\n    });\n  }\n}\n","import Parsley from 'parsleyjs';\n\nimport { owlyApiHttpClient } from './owly-api-http-client';\n\nconst getFormElementData = ($formElement) =>\n  $formElement.serializeArray().reduce(\n    (acc, { name, value }) => ({\n      ...acc,\n      [name]: value,\n    }),\n    {}\n  );\n\nfunction submitHandler(event) {\n  const $formElement = event.$element;\n  const $submitBtn = $formElement.find('button[type=submit]');\n  const $alert = $formElement.find('div[role=alert]');\n\n  $submitBtn.prop('disabled', true);\n\n  owlyApiHttpClient\n    .createLead({\n      data: getFormElementData($formElement),\n    })\n    .then(() => {\n      $submitBtn.prop('disabled', false);\n      $formElement.trigger('reset');\n      $alert.removeClass('d-none');\n      setTimeout(() => $alert.addClass('d-none'), 5000);\n      event.reset();\n    });\n\n  return false;\n}\n\nexport default async function initForm(formSelector) {\n  const parsley = new Parsley.Factory(formSelector, {\n    errorClass: 'is-invalid',\n    successClass: 'is-valid',\n    errorsWrapper: '<div class=\"invalid-feedback\"></div>',\n    errorTemplate: '<div></div>',\n  });\n\n  parsley.on('form:submit', submitHandler);\n}\n"],"names":["composeUrl","url","params","arguments","length","undefined","matches","match","parsedUrl","forEach","name","replace","createHttpClient","_ref","baseURL","headers","endpoints","timeout","axiosInstance","axios","create","httpClient","Object","entries","_ref2","endpointName","options","method","urlParams","config","data","composedUrl","includes","owlyApiHttpClient","getProject","createLead","getProjectAvailability","_data$items","product","companyCode","projectId","token","itemCallback","limit","status","items","item","getFormElementData","$formElement","serializeArray","reduce","acc","value","submitHandler","event","$element","$submitBtn","find","$alert","prop","then","trigger","removeClass","setTimeout","addClass","reset","initForm","formSelector","parsley","Parsley","Factory","errorClass","successClass","errorsWrapper","errorTemplate","on"],"mappings":"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"}